

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plugins &mdash; EPICS support for quad electrometers/picoammeters</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/my_theme.css?v=254ed751" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="TetrAMM Acquisition Modes" href="tetramm_modes.html" />
    <link rel="prev" title="Databases" href="databases.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            quadEM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">Databases</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="tetramm_modes.html">TetrAMM Acquisition Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tetramm_scanning.html">Scanning with the TetrAMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1"><a class="reference internal" href="setup.html">Setup</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">quadEM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Plugins</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/plugins.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plugins">
<h1>Plugins<a class="headerlink" href="#plugins" title="Link to this heading"></a></h1>
<p>The example IOCs provided with quadEM load a file called commonPlugins.cmd, which
loads the following set of plugins from the areaDetector module. For more information
see the documentation in the links in the table below. Other plugins can also be
loaded, for example the TIFF, HDF5 or Nexus file writing plugins, etc.</p>
<table class="table-bordered table-striped table-hover docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Plugin type</p></th>
<th class="head"><p>Record prefixes</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>NDPluginStats</p></td>
<td><p>$(P)$(R)Current[1-4]:</p></td>
<td><p>Statistics for the current values. The average value is $(P)$(R)Current[1-4]:MeanValue_RBV.
Many other statistics are available, including the minimum, maximum, standard deviation,
and histogram of values.</p></td>
</tr>
<tr class="row-odd"><td><p>NDPluginStats</p></td>
<td><p>$(P)$(R)Sum[X,Y,All]:</p></td>
<td><p>Statistics for the sum of currents 1+2, 3+4, and 1+2+3+4. The average value is $(P)$(R)Sum[X,Y,All]:MeanValue_RBV.
Many other statistics are available, including the minimum, maximum, standard deviation,
and histogram of values.</p></td>
</tr>
<tr class="row-even"><td><p>NDPluginStats</p></td>
<td><p>$(P)$(R)Diff[X,Y]:</p></td>
<td><p>Statistics for the differences of current 2-1 and 4-3. The average value is $(P)$(R)Diff[X,Y]:MeanValue_RBV.
Many other statistics are available, including the minimum, maximum, standard deviation,
and histogram of values.</p></td>
</tr>
<tr class="row-odd"><td><p>NDPluginStats</p></td>
<td><p>$(P)$(R)Pos[X,Y]:</p></td>
<td><p>Statistics for the positions. The average value is $(P)$(R)Pos[X,Y]:MeanValue_RBV.
Many other statistics are available, including the minimum, maximum, standard deviation,
and histogram of values.</p></td>
</tr>
<tr class="row-even"><td><p>NDPluginStdArrays</p></td>
<td><p>$(P)$(R)image1:</p></td>
<td><p>Plugin that receives NDArray callbacks of dimension [11,NumAveraged_RBV] and puts
this data into an EPICS waveform record. This can be used to provide access to all
of the data from quadEM to any Channel Access client.</p></td>
</tr>
<tr class="row-odd"><td><p>NDFileNetCDF</p></td>
<td><p>$(P)$(R)netCDF1:</p></td>
<td><p>Plugin that receives NDArray callbacks of dimension [11,NumAveraged_RBV] and writes
this data into a netCDF file. This can be done in Single mode, writing one array
per file. o It can also be done in Stream mode, which continuously appends arrays
to a single netCDF file.</p></td>
</tr>
<tr class="row-even"><td><p>NDPluginTimeSeries</p></td>
<td><p>$(P)$(R)TS:</p></td>
<td><p>Plugin that receives NDArray callbacks of dimension [11,NumAveraged_RBV] and forms
11 different time-series arrays. This plugin provides a time-history (like a digital
scope) of the current, sum, difference and position at speeds up to 20000Hz (TetrAMM),
6510 Hz (AH501 series), 1000Hz (AH401 series) or 813 Hz (APS_EM). The time per point
can be greater than the sampling time, in which case it does averaging. The time
series can operate in a fixed-length mode where acquisition stops after the specified
number of time points have been collected. This mode is suited for data-acquisition
applications, such as on-the-fly scanning. The time series plugin can also operate
in a circular buffer mode with continuous acquisition and display of the most recent</p></td>
</tr>
<tr class="row-odd"><td><p>NDPluginFFT</p></td>
<td><p>$(P)$(R)FFT[1-11]:</p></td>
<td><p>Plugin that receives the time-series arrays from the NDPluginTimeSeries plugin and
computes the frequency power-spectrum of each signal. This plugin can also average
the FFTs to improve the signal/noise ratio.</p></td>
</tr>
</tbody>
</table>
<p>Note that the first time the IOC is started all of the plugins will have EnableCallbacks=Disable.
It is necessary to enable each of the plugins that will be used. The plugins will
also initially start with CallbacksBlock=No. Setting CallbacksBlock=Yes can reduce
CPU load on slow processors like the MVME2100 (see the performance tables below).
The values of EnableCallbacks and CallbacksBlock are saved by autosave, and will
be restored the next time the IOC is started.</p>
<blockquote>
<div><p>This is the medm screen for all of the plugins defined in commonPlugins.cmd.</p>
</div></blockquote>
<figure class="align-center" id="id1">
<img alt="_images/QECommonPlugins.png" src="_images/QECommonPlugins.png" />
<figcaption>
<p><span class="caption-text">This is the medm screen for the Current1: NDPluginStats plugin loaded by commonPlugins.cmd.</span><a class="headerlink" href="#id1" title="Link to this image"></a></p>
</figcaption>
</figure>
<figure class="align-center">
<img alt="_images/QENDStats.png" src="_images/QENDStats.png" />
</figure>
<p>This is the medm screen for the netCDF1: NDFileNetCDF plugin loaded by commonPlugins.cmd.</p>
<figure class="align-center">
<img alt="_images/QENetCDF.png" src="_images/QENetCDF.png" />
</figure>
<p>This is the medm screen to control the NDPluginTimeSeries plugin. In this example
the time per point from the TetrAMM is 50 microseconds, and averaging time for the
time series plugin is 1 millisecond, or 20 points. The plugin has 2000 time points,
and is operating in circular buffer mode.</p>
<figure class="align-center">
<img alt="_images/quadEM_TimeSeries.png" src="_images/quadEM_TimeSeries.png" />
</figure>
<p>This is a plot of the time series for Current 1. It shows the last 2 seconds of
data in circular buffer mode.</p>
<figure class="align-center">
<img alt="_images/quadEM_TimeSeriesPlot.png" src="_images/quadEM_TimeSeriesPlot.png" />
</figure>
<p>This is a plot of the time series for the horizontal currents, sum, and position.
It shows the last 2 seconds of data in circular buffer mode.</p>
<figure class="align-center">
<img alt="_images/quadEM_HorizontalTimeSeriesPlot.png" src="_images/quadEM_HorizontalTimeSeriesPlot.png" />
</figure>
<p>This is a plot of the FFT for Current 1. DC offset suppression is enabled and 10
FFTs are being averaged to improve the signal/noise ratio.</p>
<figure class="align-center">
<img alt="_images/quadEM_NDFFTFreqSpectrumPlot.png" src="_images/quadEM_NDFFTFreqSpectrumPlot.png" />
</figure>
<p>This is an medm screen for control of all 11 FFT plugins.</p>
<figure class="align-center">
<img alt="_images/QEFFTPlugins.png" src="_images/QEFFTPlugins.png" />
</figure>
<p>This is an medm screen that displays the FFTs of the Current, Sum, and Position
for the time-series data above. 100 FFTs are being averaged to improve the signal/noise
ratio.</p>
<figure class="align-center">
<img alt="_images/quadEM_HorizontalFFTPlot.png" src="_images/quadEM_HorizontalFFTPlot.png" />
</figure>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="databases.html" class="btn btn-neutral float-left" title="Databases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="tetramm_modes.html" class="btn btn-neutral float-right" title="TetrAMM Acquisition Modes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Mark Rivers.
      <span class="lastupdated">Last updated on 2025-November-20.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>