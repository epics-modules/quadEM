

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="./">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Setup &mdash; EPICS support for quad electrometers/picoammeters</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
      <link rel="stylesheet" type="text/css" href="_static/css/my_theme.css?v=254ed751" />

  
      <script src="_static/jquery.js?v=5d32c60e"></script>
      <script src="_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="_static/documentation_options.js?v=5929fcd5"></script>
      <script src="_static/doctools.js?v=9bcbadda"></script>
      <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Performance" href="performance.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            quadEM
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="databases.html">Databases</a></li>
<li class="toctree-l1"><a class="reference internal" href="plugins.html">Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="tetramm_modes.html">TetrAMM Acquisition Modes</a></li>
<li class="toctree-l1"><a class="reference internal" href="tetramm_scanning.html">Scanning with the TetrAMM</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Setup</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#tetramm-setup">TetrAMM Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ah401-and-ah501-series-setup">AH401 and AH501 Series Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nsls-em-setup">NSLS_EM Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#nsls2-em-setup">NSLS2_EM Setup</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aps-electrometer-setup">APS Electrometer Setup</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">quadEM</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Setup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/setup.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="setup">
<h1>Setup<a class="headerlink" href="#setup" title="Link to this heading"></a></h1>
<p>All of the device-dependent startup scripts invoke <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/commonPlugins.cmd">commonPlugins.cmd</a>.
This file can be edited to add additional
plugins, such as the TIFF, HDF5, or Nexus file writers, etc.</p>
<p>Each iocBoot/iocXXX directory, e.g. iocBoot/iocTetrAMM, contains an example startup
script for Linux and Windows (st.cmd) and another for vxWorks (st.cmd.vxWorks).
Each of these startup scripts invokes the device-dependent startup script(s), e.g.
TetrAMM.cmd, NSLS_EM.cmd, etc.</p>
<section id="tetramm-setup">
<h2>TetrAMM Setup<a class="headerlink" href="#tetramm-setup" title="Link to this heading"></a></h2>
<p>These meters communicate via IP, so they must be configured with an IP address reachable
from the host IOC machine. The CAEN ELS Device Manager software must be used to
configure the device IP address and port number.</p>
<p>An example startup script is provided in <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocTetrAMM/TetrAMM.cmd">TetrAMM.cmd</a>.</p>
<p>This will need to be edited to set the correct IP address of the meter to be used.</p>
</section>
<section id="ah401-and-ah501-series-setup">
<h2>AH401 and AH501 Series Setup<a class="headerlink" href="#ah401-and-ah501-series-setup" title="Link to this heading"></a></h2>
<p>These meters communicate via IP, so they must be configured with an IP address reachable
from the host IOC machine. The Lantronix module in the meters can be configured
to use either UDP or TCP. UDP can reduce CPU load, however it is more susceptible
to synchronization problems since it does not retransmit dropped packets. The startup
script must include the UDP qualifier on the drvAsynIPPortConfigure command if UDP
is selected.</p>
<p>Example startup scripts are provided in <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocAH401B/AH401B.cmd">AH401B.cmd</a> and <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocAH501/AH501.cmd">AH501.cmd</a>.</p>
<p>These will need to be edited to set the correct IP address of the meters to be used.</p>
<p>These scripts each invoke a generic script <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/AHxxx.cmd">AHxxx.cmd</a>.</p>
</section>
<section id="nsls-em-setup">
<h2>NSLS_EM Setup<a class="headerlink" href="#nsls-em-setup" title="Link to this heading"></a></h2>
<p>These meters communicate via IP. They only support DHCP, they cannot be given a
static IP address. Each module on the subnet must have a unique Module ID, which
is set by a 16-position rotary switch on the device front panel. The driver sends
a broadcast message on the subnet to determine the Module ID and current IP address
of all NSLS_EM modules. If the specified module ID is found then it configures communication
to that module by calling drvAsynIPPortConfigure internally.</p>
<p>An example startup script is provided in <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocNSLS_EM/NSLS_EM.cmd">NSLS_EM.cmd</a>.</p>
<p>This will need to be edited to set the broadcast address of the network the device
is connected to, and the Module ID of the device.</p>
</section>
<section id="nsls2-em-setup">
<h2>NSLS2_EM Setup<a class="headerlink" href="#nsls2-em-setup" title="Link to this heading"></a></h2>
<p>These meters communicate via IP. They run the EPICS IOC software internally on the
Zynq processor.</p>
<p>An example startup script is provided in <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocNSLS2_EM/NSLS2_EM.cmd">NSLS2_EM.cmd</a>.</p>
<p>This will need to be edited to set the Module ID of the device.</p>
</section>
<section id="aps-electrometer-setup">
<h2>APS Electrometer Setup<a class="headerlink" href="#aps-electrometer-setup" title="Link to this heading"></a></h2>
<p>The APS_EM VME card cannot generate interrupts, but it can output a TTL pulse each
time new data is available, at up to 815 Hz. If this pulse is input to an Ip-Unidig
(or other asyn digital I/O device with interrupt and callback capabilities), then
the ipUnidig interrupt routine will call the APS_EM driver each time new data is
available. The Ip-Unidig channel where the APS_EM pulse is connected is specified
in the unidigChan argument to drvAPS_EMConfigure command in the startup script.
If an Ip-Unidig or other interrupt source is not being used then the APS_EM driver
will poll for new data at the system clock rate, typically 60Hz.</p>
<p>An example startup script is provided in <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocAPS_EM/APS_EM.cmd">APS_EM.cmd</a> and <a class="reference external" href="https://github.com/epics-modules/quadEM/tree/master/iocBoot/iocAPS_EM/st.cmd.vxWorks">st.cmd.vxWorks</a>.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="performance.html" class="btn btn-neutral float-left" title="Performance" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Mark Rivers.
      <span class="lastupdated">Last updated on 2025-November-16.
      </span></p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>